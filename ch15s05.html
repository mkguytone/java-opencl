<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>15.5. up-sweep（掃き上げ）</title><link rel="stylesheet" type="text/css" href="index.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Java-OpenCL入門" /><link rel="up" href="ch15.html" title="第15章 基数整列" /><link rel="prev" href="ch15s04.html" title="15.4. Prefix Sumへの適用" /><link rel="next" href="ch15s06.html" title="15.6. down-sweep（掃き下げ）" /><meta xmlns="" name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0" /><script xmlns="" type="text/javascript" src="prettify/prettify.js"></script><link xmlns="" rel="stylesheet" type="text/css" href="prettify/skins/sons-of-obsidian.css" /><script xmlns="">
    window.addEventListener("load", function() {
      PR.prettyPrint();
	  });	
	</script><script xmlns="" type="text/javascript" src="script/head.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="ch15s04.html">戻る</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch15s06.html">次へ</a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="_up_sweep_掃き上げ"></a>15.5. up-sweep（掃き上げ）</h2></div></div></div><p>up-sweep（掃き上げ）での更新は「Prefix-Sumの要素分解図」（<a class="xref" href="ch15s02.html#prefix-sum" title="表15.3 表：Prefix-Sumの要素分解図（括弧内の数は式番号に該当）">表15.3「表：Prefix-Sumの要素分解図（括弧内の数は式番号に該当）」</a>）と「<a class="xref" href="ch15s02.html#prefix-sum-eqn" title="図15.1 Bucket Scanの算出式（要素8の場合）">図15.1「Bucket Scanの算出式（要素8の場合）」</a>」のプロセスの内、出力配列の計算を抜いた部分となります。</p><p>up-sweepは以下の擬似コードで表すことができます。</p><p><strong>擬似コード：掃き上げ. </strong>
</p><pre xmlns="" class="prettyprint">for( d = 0 ; d &lt; log(n) - 1 ; d++)
    for( i = 0 ; i &lt; n ; n+=2のd+1乗)
    　x[i + 2のd+1乗 – 1] =
        x[i + 2のd乗 – 1] +
        x[i + 2のd+1乗 – 1]</pre><p>
</p><div class="informalfigure"><div class="mediaobject"><img src="radix-algorithm-up-sweep.png" alt="radix-algorithm-up-sweep.png" /></div></div><p>このコードでは、dはアルゴリズムのステップを指し、0から始めます。まずdが0の場合を見てみましょう。</p><pre xmlns="" class="prettyprint">d = 0
i = 0, 2, 4, 6
x[i + 1] = x[i] + x[i + 1]</pre><p>dが0の場合に更新されるインデックスは(0,1)、(2,3)、(4,5)、(6,7)となります。単純に隣接した要素を偶数のインデックスの位置を起点に加算します。</p><pre xmlns="" class="prettyprint">d = 1
i = 0, 4
x[i + 3] = x[i + 1] + x[i + 3]</pre><p>dが1の場合に更新されるインデックスは(1,3)、(5,7)となります。ステップで算出した値をさらに加算・累積していきます。</p><pre xmlns="" class="prettyprint">d = 2
i = 0
x[i + 7] = x[i + 3] + x[i + 7]</pre><p>最後にdが2の場合ですが、更新されるインデックスは（3,7）となります。インデックス7の要素は、要素を全て加算した数値にアップデートされます。</p><p>下記の表はup-sweepアルゴリズムの各ステップをまとめたものです。</p><div class="table"><a id="idm11848"></a><p class="title"><strong>表15.4 up-sweepアルゴリズム</strong></p><div class="table-contents"><table class="table" summary="up-sweepアルゴリズム" cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; border-left: 3px solid #527bbd; border-right: 3px solid #527bbd; "><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /><col class="col_5" /><col class="col_6" /><col class="col_7" /><col class="col_8" /><col class="col_9" /></colgroup><tbody><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">入力</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">1</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">5</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">10</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">7</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">4</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">15</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">2</pre></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">9</pre></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">Step=0</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">6</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">17</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">19</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">11</pre></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">Step=1</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">23</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">30</pre></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">Step=2</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout"></pre></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">53</pre></td></tr><tr><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">入力更新</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">1</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">6</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">10</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">23</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">4</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">19</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">2</pre></td><td style="" align="left" valign="top"><pre class="literallayout">53</pre></td></tr></tbody></table></div></div><br class="table-break" /><p>注目すべき点としては「更新された入力配列」がこの時点ではPrefix-Sumを構成しないことです。</p><p>以下の項目では、down-sweepを使いPrefix-Sumとなる配列を作ります。</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch15s04.html">戻る</a> </td><td width="20%" align="center"><a accesskey="u" href="ch15.html">上に戻る</a></td><td width="40%" align="right"> <a accesskey="n" href="ch15s06.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div><wrapper xmlns=""><p>Copyright 2018-2019, by Masaki Komatsu</p>


</wrapper></body></html>